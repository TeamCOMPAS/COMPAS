name: COMPAS compile test

on: [pull_request]

jobs:
  compas:
    name: Build COMPAS
    runs-on: ubuntu-18.04
    steps:
      - uses: actions/checkout@v2

      - name: Install dependencies 
        run: |
          sudo apt install texlive-latex-extra cm-super dvipng
          sudo apt update && sudo apt install g++ libboost-all-dev libgsl-dev libhdf5-serial-dev 
          
      # - name: Build Compas
      #   run: |
      #     cd src && make -j $(nproc) -f Makefile
      #     ./COMPAS -v

      - name: Install Python and required packages
        run: |
          # sudo apt-get install python3.8 python3.8-dev python3.8-distutils python3.8-venv
          # python3.8 -m venv dev3.8
          # source dev3.8/bin/activate
          sudo apt-get install gcc libpq-dev -y
          sudo apt-get install python-dev  python-pip -y
          sudo apt-get install python3-dev python3-pip python3-venv python3-wheel -y
          pip3 install --upgrade setuptools\
          pip3 install wheel
          pip3 install -r requirements.txt
      
      # - name: Run Post-Processing Python Scripts
      #   run: |
      #     export COMPAS_ROOT_DIR=${GITHUB_WORKSPACE}
      #     cd utils/example_plots/methods_paper_plots/detailed_evolution
      #     python3 runSubmitDemo.py
      #     python3 plot_detailed_evolution.py
